(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var n;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(n||(n={}));class r{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class s{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class i extends s{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new i),this.instance}addProject(e,t,s){const i=new r(Math.random().toString(),e,t,s,n.Active);this.projects.push(i),this.updateListeners()}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}}const o=i.getInstance();class l extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure(),this.renderContent()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}getUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=+this.peopleInputElement.value,r=[{value:e,required:!0,minLength:3},{value:t,required:!0,minLength:3},{value:n,required:!0,min:1}];let s=!0;for(let e of r)s=s&&!((i=e).required&&0===i.value.toString().trim().length||i.minLength&&"string"==typeof i.value&&i.value.trim().length<i.minLength||i.maxLength&&"string"==typeof i.value&&i.value.trim().length>i.maxLength||i.min&&"number"==typeof i.value&&i.value<i.min||i.max&&"number"==typeof i.value&&i.value>i.max);var i;if(s)return[e,t,n];alert("Invalid input.")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.getUserInput();if(Array.isArray(t)){const[e,n,r]=t;o.addProject(e,n,r),this.clearInputs(),console.log(e)}}}!function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);i>3&&o&&Object.defineProperty(t,n,o)}([t],l.prototype,"submitHandler",null);var a=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class c extends e{get people(){return 1===this.project.people?"1 person":`${this.project.people} people`}constructor(e,t){super("single-project",e,!1,t.id),this.hostId=e,this.project=t,this.configure(),this.renderContent()}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.people,this.element.querySelector("p").textContent=this.project.description}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){}}a([t],c.prototype,"dragStartHandler",null),a([t],c.prototype,"dragEndHandler",null);var d,p=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class u extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.projectType=e,this.assignedProjects=[],this.configure(),this.renderContent()}renderContent(){const e=`${this.projectType}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.projectType.toUpperCase()+" PROJECTS"}configure(){o.addListener((e=>{this.assignedProjects=e.filter((e=>"active"===this.projectType?e.status===n.Active:e.status===n.Finished)),this.renderProjects()})),this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler)}renderProjects(){this.element.querySelector("ul").innerHTML="";for(const e of this.assignedProjects)new c(this.element.querySelector("ul").id,e)}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");o.moveProject(t,"active"===this.projectType?n.Active:n.Finished),console.log(t)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}}p([t],u.prototype,"dragOverHandler",null),p([t],u.prototype,"dropHandler",null),p([t],u.prototype,"dragLeaveHandler",null),d||(d={}),new l,new u("active"),new u("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Y3FCLE9BRWhDMEQsRUFBSzFFLFNBQVdMLEVBQWNnRixXQUV2Q3RHLEtBQUt1RyxnQkFBZ0IsSUFJdkJ2RyxLQUFLUSxRQUFRbUQsaUJBQWlCLFdBQVkzRCxLQUFLd0csaUJBQy9DeEcsS0FBS1EsUUFBUW1ELGlCQUFpQixZQUFhM0QsS0FBS3lHLGtCQUNoRHpHLEtBQUtRLFFBQVFtRCxpQkFBaUIsT0FBUTNELEtBQUswRyxZQUM3QyxDQUVRSCxpQkFDTnZHLEtBQUtRLFFBQVE4QyxjQUFjLE1BQU9xRCxVQUFZLEdBRTlDLElBQUssTUFBTTVELEtBQVcvQyxLQUFLaUcsaUJBQ3pCLElBQUlYLEVBQVl0RixLQUFLUSxRQUFROEMsY0FBYyxNQUFPNUMsR0FBSXFDLEVBRTFELENBR0F5RCxnQkFBZ0IxQixHQUNWQSxFQUFNYSxjQUFnRCxlQUFoQ2IsRUFBTWEsYUFBYWlCLE1BQU0sS0FDakQ5QixFQUFNQyxpQkFDYy9FLEtBQUtRLFFBQVE4QyxjQUFjLE1BQ25DdUQsVUFBVUMsSUFBSSxhQUU5QixDQUdBSixZQUFZNUIsR0FDVixNQUFNcEUsRUFBS29FLEVBQU1hLGFBQWNvQixRQUFRLGNBQ3ZDN0QsRUFBYUosWUFDWHBDLEVBQ3FCLFdBQXJCVixLQUFLZ0csWUFDRDFFLEVBQWNxQixPQUNkckIsRUFBY2dGLFVBRXBCbEIsUUFBUUMsSUFBSTNFLEVBQ2QsQ0FHQStGLGlCQUFpQjNCLEdBQ0s5RSxLQUFLUSxRQUFROEMsY0FBYyxNQUNuQ3VELFVBQVVHLE9BQU8sWUFDL0IsRUF4QkEsR0FEQ25HLEcsb0NBVUQsR0FEQ0EsRyxnQ0FhRCxHQURDQSxHLHFDRDFFT2lGLElBQUFBLEVBQUcsSUFDWCxJQUFJMUMsRUFDSixJQUFJMkMsRUFBWSxVQUNoQixJQUFJQSxFQUFZLFciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXRzLy4vc3JjL2NvbXBvbmVudHMvYmFzZS1jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10cy8uL3NyYy9kZWNvcmF0b3JzL2F1dG9iaW5kLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHMvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10cy8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHMvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHMvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHMvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10cy8uL3NyYy9hcHAudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10cy8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb21wb25lbnQgYmFzZSBjbGFzcyB1c2luZyBnZW5lcmljc1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENvbXBvbmVudDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQsIFUgZXh0ZW5kcyBIVE1MRWxlbWVudD4ge1xuICB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gIGhvc3RFbGVtZW50OiBUO1xuICBlbGVtZW50OiBVO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHRlbXBsYXRlSWQ6IHN0cmluZyxcbiAgICBob3N0RWxlbWVudElkOiBzdHJpbmcsXG4gICAgaW5zZXJ0QXRCZWdpbm5pbmc6IGJvb2xlYW4sXG4gICAgbmV3RWxlbWVudElkPzogc3RyaW5nXG4gICkge1xuICAgIC8vIHNldHVwIGFjY2VzcyB0byBkb20gZWxlbWVudHNcbiAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgICAgdGVtcGxhdGVJZFxuICAgICkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpISBhcyBUO1xuXG4gICAgLy8gaW1wb3J0IHRlbXBsYXRlIGNvbnRlbnRcbiAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKFxuICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCxcbiAgICAgIHRydWVcbiAgICApO1xuXG4gICAgLy8gZ2V0IHRlbXBsYXRlIGNvbnRlbnRcbiAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcbiAgICBpZiAobmV3RWxlbWVudElkKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFbGVtZW50SWQ7XG4gICAgfVxuXG4gICAgdGhpcy5hdHRhY2goaW5zZXJ0QXRCZWdpbm5pbmcpO1xuICB9XG5cbiAgcHJpdmF0ZSBhdHRhY2goaW5zZXJ0QXRCZWdpbm5pbmc6IGJvb2xlYW4pIHtcbiAgICAvKipcbiAgICAgKiBhdHRhY2hcbiAgICAgKlxuICAgICAqIGNvbnZlbmllbmNlIG1ldGhvZCBmb3IgcmVuZGVyaW5nIGNvbnRlbnRcbiAgICAgKi9cbiAgICB0aGlzLmhvc3RFbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudChcbiAgICAgIGluc2VydEF0QmVnaW5uaW5nID8gJ2FmdGVyYmVnaW4nIDogJ2JlZm9yZWVuZCcsXG4gICAgICB0aGlzLmVsZW1lbnRcbiAgICApO1xuICB9XG5cbiAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XG4gIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcbn1cbiIsIi8vIGF1dG9iaW5kIGRlY29yYXRvciwgYXV0b2JpbmQgJ3RoaXMnXG5leHBvcnQgZnVuY3Rpb24gYXV0b2JpbmQoXG4gIHRhcmdldDogYW55LFxuICBtZXRob2ROYW1lOiBzdHJpbmcsXG4gIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvclxuKSB7XG4gIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgY29uc3QgYWRqRGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBnZXQoKSB7XG4gICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcbiAgICAgIHJldHVybiBib3VuZEZuO1xuICAgIH0sXG4gIH07XG4gIHJldHVybiBhZGpEZXNjcmlwdG9yO1xufVxuIiwiLy8gUHJvamVjdFN0YXR1cyBlbnVtXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHtcbiAgQWN0aXZlLFxuICBGaW5pc2hlZCxcbn1cblxuLy8gUHJvamVjdCBjbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgaWQ6IHN0cmluZyxcbiAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcbiAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcbiAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXG4gICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1c1xuICApIHt9XG59XG4iLCJpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSAnLi4vbW9kZWxzL3Byb2plY3QnO1xuXG4vLyBQcm9qZWN0IFN0YXRlLCBzaW5nbGV0b24sIHN1YnNjcmliZXIgcGF0dGVyblxudHlwZSBMaXN0ZW5lcjxUPiA9IChpdGVtczogVFtdKSA9PiB2b2lkO1xuXG5jbGFzcyBTdGF0ZTxUPiB7XG4gIHByb3RlY3RlZCBsaXN0ZW5lcnM6IExpc3RlbmVyPFQ+W10gPSBbXTtcbiAgYWRkTGlzdGVuZXIobGlzdGVuZXJGbjogTGlzdGVuZXI8VD4pIHtcbiAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGxpc3RlbmVyRm4pO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XG4gIHByaXZhdGUgcHJvamVjdHM6IFByb2plY3RbXSA9IFtdO1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0YXRlO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcbiAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xuICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gICAgfVxuICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKCk7XG4gICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gIH1cblxuICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIHBlb3BsZTogbnVtYmVyKSB7XG4gICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KFxuICAgICAgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLFxuICAgICAgdGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbixcbiAgICAgIHBlb3BsZSxcbiAgICAgIFByb2plY3RTdGF0dXMuQWN0aXZlXG4gICAgKTtcbiAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdCk7XG4gICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xuICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xuICAgICAgLy8gdXNlIHNsaWNlIHRvIG1ha2UgYSBjb3B5XG4gICAgICBsaXN0ZW5lckZuKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XG4gICAgfVxuICB9XG5cbiAgbW92ZVByb2plY3QoaWQ6IHN0cmluZywgc3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7XG4gICAgY29uc3QgcHJvamVjdCA9IHRoaXMucHJvamVjdHMuZmluZCgocHJqKSA9PiBwcmouaWQgPT09IGlkKTtcbiAgICBpZiAocHJvamVjdCAmJiBwcm9qZWN0LnN0YXR1cyAhPT0gc3RhdHVzKSB7XG4gICAgICBwcm9qZWN0LnN0YXR1cyA9IHN0YXR1cztcbiAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XG4gICAgfVxuICB9XG59XG5cbi8vIGdsb2JhbCBzdGF0ZVxuZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpO1xuIiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XG5pbXBvcnQgeyB2YWxpZGF0ZSwgVmFsaWRhdGFibGUgfSBmcm9tICcuLi91dGlsL3ZhbGlkYXRpb24nO1xuaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kJztcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3Qtc3RhdGUnO1xuXG4vLyBQcm9qZWN0SW5wdXQgY2xhc3NcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SW5wdXQgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxGb3JtRWxlbWVudD4ge1xuICB0aXRsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gIHBlb3BsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigncHJvamVjdC1pbnB1dCcsICdhcHAnLCB0cnVlLCAndXNlci1pbnB1dCcpO1xuXG4gICAgLy8gc2V0dXAgYWNjZXNzIHRvIGlucHV0IGVsZW1lbnRzXG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgJyN0aXRsZSdcbiAgICApISBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICcjZGVzY3JpcHRpb24nXG4gICAgKSEgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgJyNwZW9wbGUnXG4gICAgKSEgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgIC8vIHJlbmRlciBjb250ZW50IGluICdhcHAnXG4gICAgdGhpcy5jb25maWd1cmUoKTtcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgfVxuXG4gIGNvbmZpZ3VyZSgpIHtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5zdWJtaXRIYW5kbGVyKTtcbiAgfVxuXG4gIHJlbmRlckNvbnRlbnQoKSB7fVxuXG4gIC8vIHVzaW5nIGEgdHVwbGUgb3Igbm90aGluZyBvbiBlcnJvclxuICAvLyBUT0RPOiByZWZhY3RvciB0byBnZW5lcmljIG1ldGhvZCBhbmQgYmV0dGVyIGVycm9yIGhhbmRsaW5nXG4gIHByaXZhdGUgZ2V0VXNlcklucHV0KCk6IFtzdHJpbmcsIHN0cmluZywgbnVtYmVyXSB8IHZvaWQge1xuICAgIGNvbnN0IHVzZXJUaXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgY29uc3QgdXNlckRlc2NyID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZTtcbiAgICBjb25zdCB1c2VyUGVvcGxlID0gK3RoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuXG4gICAgY29uc3QgdmFsaWRhdGFibGVJbnB1dHM6IFZhbGlkYXRhYmxlW10gPSBbXG4gICAgICB7IHZhbHVlOiB1c2VyVGl0bGUsIHJlcXVpcmVkOiB0cnVlLCBtaW5MZW5ndGg6IDMgfSxcbiAgICAgIHsgdmFsdWU6IHVzZXJEZXNjciwgcmVxdWlyZWQ6IHRydWUsIG1pbkxlbmd0aDogMyB9LFxuICAgICAgeyB2YWx1ZTogdXNlclBlb3BsZSwgcmVxdWlyZWQ6IHRydWUsIG1pbjogMSB9LFxuICAgIF07XG5cbiAgICAvLyB2YWxpZGF0aW9uXG4gICAgbGV0IGlzVmFsaWQgPSB0cnVlO1xuICAgIGZvciAobGV0IHZhbGlkYXRhYmxlSW5wdXQgb2YgdmFsaWRhdGFibGVJbnB1dHMpIHtcbiAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRlKHZhbGlkYXRhYmxlSW5wdXQpO1xuICAgIH1cbiAgICBpZiAoaXNWYWxpZCkge1xuICAgICAgcmV0dXJuIFt1c2VyVGl0bGUsIHVzZXJEZXNjciwgdXNlclBlb3BsZV07XG4gICAgfVxuXG4gICAgYWxlcnQoJ0ludmFsaWQgaW5wdXQuJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcHJpdmF0ZSBjbGVhcklucHV0cygpIHtcbiAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgcHJpdmF0ZSBzdWJtaXRIYW5kbGVyKGV2ZW50OiBFdmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nZXRVc2VySW5wdXQoKTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh1c2VySW5wdXQpKSB7XG4gICAgICBjb25zdCBbdGl0bGUsIGRlc2MsIHBlb3BsZV0gPSB1c2VySW5wdXQ7XG4gICAgICBwcm9qZWN0U3RhdGUuYWRkUHJvamVjdCh0aXRsZSwgZGVzYywgcGVvcGxlKTtcbiAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKTtcbiAgICAgIGNvbnNvbGUubG9nKHRpdGxlKTtcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGFibGUge1xuICB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbjtcbiAgcmVxdWlyZWQ6IGJvb2xlYW47XG4gIG1pbkxlbmd0aD86IG51bWJlcjtcbiAgbWF4TGVuZ3RoPzogbnVtYmVyO1xuICBtaW4/OiBudW1iZXI7XG4gIG1heD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKGlucHV0OiBWYWxpZGF0YWJsZSk6IGJvb2xlYW4ge1xuICBpZiAoaW5wdXQucmVxdWlyZWQpIHtcbiAgICBpZiAoaW5wdXQudmFsdWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgaWYgKGlucHV0Lm1pbkxlbmd0aCAmJiB0eXBlb2YgaW5wdXQudmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKGlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPCBpbnB1dC5taW5MZW5ndGgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBpZiAoaW5wdXQubWF4TGVuZ3RoICYmIHR5cGVvZiBpbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAoaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA+IGlucHV0Lm1heExlbmd0aCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChpbnB1dC5taW4gJiYgdHlwZW9mIGlucHV0LnZhbHVlID09PSAnbnVtYmVyJykge1xuICAgIGlmIChpbnB1dC52YWx1ZSA8IGlucHV0Lm1pbikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChpbnB1dC5tYXggJiYgdHlwZW9mIGlucHV0LnZhbHVlID09PSAnbnVtYmVyJykge1xuICAgIGlmIChpbnB1dC52YWx1ZSA+IGlucHV0Lm1heCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cbiIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vYmFzZS1jb21wb25lbnQnO1xuaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCc7XG5pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gJy4uL2RlY29yYXRvcnMvYXV0b2JpbmQnO1xuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0JztcblxuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtXG4gIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+XG4gIGltcGxlbWVudHMgRHJhZ2dhYmxlXG57XG4gIGdldCBwZW9wbGUoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvamVjdC5wZW9wbGUgPT09IDFcbiAgICAgID8gJzEgcGVyc29uJ1xuICAgICAgOiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZW9wbGVgO1xuICB9XG5cbiAgY29uc3RydWN0b3IocHVibGljIGhvc3RJZDogc3RyaW5nLCBwcml2YXRlIHByb2plY3Q6IFByb2plY3QpIHtcbiAgICBzdXBlcignc2luZ2xlLXByb2plY3QnLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKTtcbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xuICB9XG5cbiAgY29uZmlndXJlKCk6IHZvaWQge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kSGFuZGxlcik7XG4gIH1cblxuICByZW5kZXJDb250ZW50KCk6IHZvaWQge1xuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC50aXRsZTtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDMnKSEudGV4dENvbnRlbnQgPSB0aGlzLnBlb3BsZTtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigncCcpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kZXNjcmlwdGlvbjtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcbiAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoJ3RleHQvcGxhaW4nLCB0aGlzLnByb2plY3QuaWQpO1xuICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJztcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBkcmFnRW5kSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7fVxufVxuIiwiaW1wb3J0IHsgUHJvamVjdElucHV0IH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQnO1xuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0JztcblxubmFtZXNwYWNlIEFwcCB7XG4gIG5ldyBQcm9qZWN0SW5wdXQoKTtcbiAgbmV3IFByb2plY3RMaXN0KCdhY3RpdmUnKTtcbiAgbmV3IFByb2plY3RMaXN0KCdmaW5pc2hlZCcpO1xufVxuIiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCc7XG5pbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSAnLi4vbW9kZWxzL3Byb2plY3QnO1xuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvcHJvamVjdC1zdGF0ZSc7XG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gJy4vcHJvamVjdC1pdGVtJztcbmltcG9ydCB7IGF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XG5cbi8vUHJvamVjdExpc3QgY2xhc3NcbmV4cG9ydCBjbGFzcyBQcm9qZWN0TGlzdFxuICBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEVsZW1lbnQ+XG4gIGltcGxlbWVudHMgRHJhZ1RhcmdldFxue1xuICBhc3NpZ25lZFByb2plY3RzOiBQcm9qZWN0W107XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBwcm9qZWN0VHlwZTogJ2FjdGl2ZScgfCAnZmluaXNoZWQnKSB7XG4gICAgc3VwZXIoJ3Byb2plY3QtbGlzdCcsICdhcHAnLCBmYWxzZSwgYCR7cHJvamVjdFR5cGV9LXByb2plY3RzYCk7XG4gICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gW107XG5cbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xuICB9XG5cbiAgcmVuZGVyQ29udGVudCgpIHtcbiAgICBjb25zdCBsaXN0SWQgPSBgJHt0aGlzLnByb2plY3RUeXBlfS1wcm9qZWN0cy1saXN0YDtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQgPSBsaXN0SWQ7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID1cbiAgICAgIHRoaXMucHJvamVjdFR5cGUudG9VcHBlckNhc2UoKSArICcgUFJPSkVDVFMnO1xuICB9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIC8vIHNldHVwIGxpc3RlbmVyIGZvciBzdGF0ZVxuICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xuICAgICAgLy8gZmlsdGVyIHByb2plY3RzIGJ5IGxpc3QgdHlwZVxuICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKChpdGVtKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnByb2plY3RUeXBlID09PSAnYWN0aXZlJykge1xuICAgICAgICAgIHJldHVybiBpdGVtLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5BY3RpdmU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGl0ZW0uc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkO1xuICAgICAgfSk7XG4gICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XG4gICAgfSk7XG5cbiAgICAvLyBkcmFnIGxpc3RlbmVyc1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpIHtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaW5uZXJIVE1MID0gJyc7XG5cbiAgICBmb3IgKGNvbnN0IHByb2plY3Qgb2YgdGhpcy5hc3NpZ25lZFByb2plY3RzKSB7XG4gICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcm9qZWN0KTtcbiAgICB9XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgZHJhZ092ZXJIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyICYmIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gJ3RleHQvcGxhaW4nKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgY29uc3QgbGlzdEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XG4gICAgICBsaXN0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdkcm9wcGFibGUnKTtcbiAgICB9XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGlkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XG4gICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KFxuICAgICAgaWQsXG4gICAgICB0aGlzLnByb2plY3RUeXBlID09PSAnYWN0aXZlJ1xuICAgICAgICA/IFByb2plY3RTdGF0dXMuQWN0aXZlXG4gICAgICAgIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZFxuICAgICk7XG4gICAgY29uc29sZS5sb2coaWQpO1xuICB9XG5cbiAgQGF1dG9iaW5kXG4gIGRyYWdMZWF2ZUhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGxpc3RFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhO1xuICAgIGxpc3RFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJ0ZW1wbGF0ZUlkIiwiaG9zdEVsZW1lbnRJZCIsImluc2VydEF0QmVnaW5uaW5nIiwibmV3RWxlbWVudElkIiwidGhpcyIsInRlbXBsYXRlRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJob3N0RWxlbWVudCIsImltcG9ydGVkTm9kZSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiZWxlbWVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiaWQiLCJhdHRhY2giLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJhdXRvYmluZCIsInRhcmdldCIsIm1ldGhvZE5hbWUiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJ2YWx1ZSIsImNvbmZpZ3VyYWJsZSIsImdldCIsImJpbmQiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJTdGF0ZSIsImxpc3RlbmVycyIsImFkZExpc3RlbmVyIiwibGlzdGVuZXJGbiIsInB1c2giLCJQcm9qZWN0U3RhdGUiLCJzdXBlciIsInByb2plY3RzIiwic3RhdGljIiwiaW5zdGFuY2UiLCJhZGRQcm9qZWN0IiwibmV3UHJvamVjdCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsIkFjdGl2ZSIsInVwZGF0ZUxpc3RlbmVycyIsInNsaWNlIiwibW92ZVByb2plY3QiLCJwcm9qZWN0IiwiZmluZCIsInByaiIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwiUHJvamVjdElucHV0IiwidGl0bGVJbnB1dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJjb25maWd1cmUiLCJyZW5kZXJDb250ZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInN1Ym1pdEhhbmRsZXIiLCJnZXRVc2VySW5wdXQiLCJ1c2VyVGl0bGUiLCJ1c2VyRGVzY3IiLCJ1c2VyUGVvcGxlIiwidmFsaWRhdGFibGVJbnB1dHMiLCJyZXF1aXJlZCIsIm1pbkxlbmd0aCIsIm1pbiIsImlzVmFsaWQiLCJ2YWxpZGF0YWJsZUlucHV0IiwiaW5wdXQiLCJ0cmltIiwibGVuZ3RoIiwibWF4TGVuZ3RoIiwibWF4IiwiYWxlcnQiLCJjbGVhcklucHV0cyIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VySW5wdXQiLCJBcnJheSIsImlzQXJyYXkiLCJkZXNjIiwiY29uc29sZSIsImxvZyIsIlByb2plY3RJdGVtIiwiaG9zdElkIiwiZHJhZ1N0YXJ0SGFuZGxlciIsImRyYWdFbmRIYW5kbGVyIiwidGV4dENvbnRlbnQiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsIkFwcCIsIlByb2plY3RMaXN0IiwicHJvamVjdFR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwibGlzdElkIiwidG9VcHBlckNhc2UiLCJmaWx0ZXIiLCJpdGVtIiwiRmluaXNoZWQiLCJyZW5kZXJQcm9qZWN0cyIsImRyYWdPdmVySGFuZGxlciIsImRyYWdMZWF2ZUhhbmRsZXIiLCJkcm9wSGFuZGxlciIsImlubmVySFRNTCIsInR5cGVzIiwiY2xhc3NMaXN0IiwiYWRkIiwiZ2V0RGF0YSIsInJlbW92ZSJdLCJzb3VyY2VSb290IjoiIn0=